# OpenList Windows管理工具

一个基于wxPython开发的OpenList服务器Windows管理工具，专为视障用户设计，提供完整无障碍支持。

## 🎯 版本信息

**当前版本：v1.1.0**
**更新日期：2025年10月17日**
**版本规范：语义化版本控制 (主版本.次版本.修订版本)**

## ✨ 功能特性

- 🔗 **服务器登录管理**：启动时选择服务器并登录
- 📁 **文件管理**：登录后直接管理服务器文件
- 📂 **文件夹导航**：双击进入子文件夹，退格键返回上级目录
- 🎵 **音频播放**：集成音频播放器，支持音频文件直接播放
- 🎬 **视频播放**：支持视频文件播放（使用独立播放器窗口）
- 🎛️ **播放控制**：完整的播放菜单、快捷键和状态栏显示
- 🛠️ **文件操作**：查看文件信息、复制文件名和路径
- ⚡ **快速切换**：Ctrl+Q快速切换到其他服务器（无确认对话框）
- 🎧 **音频设备**：支持音频输出设备选择
- ⏯️ **播放列表**：自动播放列表导航（上一个/下一个）
- 🔄 **播放控制**：快进快退、音量调节、倍速播放
- ♿ **完整无障碍支持**：100%键盘可操作，专为屏幕阅读器优化
- ⌨️ **智能键盘导航**：完整的Tab键导航和快捷键支持
- 🔒 **安全存储**：密码采用Fernet加密存储
- 📊 **状态反馈**：5字段状态栏显示播放状态和文件信息
- 🎨 **专业界面**：专用的文件管理界面，界面简洁无多余控件

## 🖥️ 系统要求

- **操作系统**：Windows 10/11
- **Python版本**：Python 3.8+
- **屏幕阅读器**：推荐NVDA或其他兼容读屏软件
- **VLC媒体播放器**：需要安装VLC 3.0+（用于音频/视频播放支持）

## 🚀 快速开始

### 开发环境运行

1. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

2. **运行程序**
   ```bash
   python main.py
   ```

3. **打包为可执行文件**
   ```bash
   python build.py
   ```

### 基本使用流程

1. **启动程序**：运行`python main.py`，自动打开服务器选择对话框
2. **选择服务器**：在对话框中选择要连接的服务器
3. **登录服务器**：按`Alt+L`或点击连接按钮进行登录
4. **管理文件**：登录成功后直接进入文件管理界面
5. **文件夹导航**：双击文件夹进入子目录，按退格键返回上级目录
6. **切换服务器**：按`Ctrl+Q`随时切换到其他服务器（直接切换，无确认对话框）

## 📁 项目结构

```
openlist-windows/
├── main.py                    # 主程序入口
├── requirements.txt           # 依赖包列表
├── build.py                  # 打包脚本
├── README.md                 # 项目说明文档
├── HELP_DOCUMENTATION.md      # 完整用户帮助文档
├── CLAUDE.md                 # 开发团队配置指南
├── version_info.txt          # 版本信息文件
├── OpenListManager.spec      # PyInstaller配置
├── config/                   # 配置文件目录
├── logs/                     # 日志文件目录
└── src/                      # 源代码目录
    ├── ui/                   # 用户界面模块
    │   ├── file_manager_window.py     # 文件管理主窗口
    │   ├── server_select_dialog.py   # 服务器选择对话框
    │   ├── server_dialog.py         # 服务器配置对话框
    │   ├── audio_player_controller.py # 音频播放控制器
    │   └── media_player_window.py    # 媒体播放器窗口
    ├── core/                 # 核心功能模块
    │   ├── config_manager.py     # 配置管理器
    │   ├── logger.py            # 日志系统
    │   └── version.py           # 版本信息管理
    ├── api/                  # API客户端模块
    │   └── openlist_client.py     # OpenList客户端（支持文件操作）
    └── media/                # 媒体播放模块
        ├── audio_player.py        # 音频播放器核心
        ├── media_player_core.py   # 媒体播放器核心
        ├── vlc_loader.py          # VLC库加载器
        └── file_detector.py       # 媒体文件检测器
```

## ⌨️ 无障碍操作指南

### 基本导航
- **Tab键**：在控件间正向切换（服务器选择 → 连接 → 添加 → 编辑 → 删除）
- **Shift+Tab**：在控件间反向切换
- **方向键**：在服务器选择框中选择服务器
- **空格键**：激活按钮
- **回车键**：在服务器选择框中连接服务器

### 快捷键

#### 服务器选择对话框
- **Alt+L**：连接到选中的服务器
- **Alt+A**：添加新服务器
- **Alt+E**：编辑选中的服务器
- **Alt+D**：删除选中的服务器
- **F1**：显示关于信息
- **Alt+F4**：退出程序

#### 文件管理窗口
- **Ctrl+Q**：切换到其他服务器
- **F5**：刷新文件列表
- **Ctrl+A**：全选文件
- **Ctrl+I**：反向选择
- **Ctrl+C**：复制文件名
- **Ctrl+Shift+C**：复制文件路径
- **Enter**：打开文件/文件夹
- **Backspace**：返回上级目录
- **Alt+F4**：退出程序

#### 音频播放快捷键
- **Ctrl+Home**：播放/暂停音频
- **Ctrl+End**：停止播放
- **Ctrl+PageUp**：播放上一个音频文件
- **Ctrl+PageDown**：播放下一个音频文件
- **Ctrl+Left**：快退5秒
- **Ctrl+Right**：快进5秒
- **Ctrl+Up**：音量增加
- **Ctrl+Down**：音量减少
- **空格键**：播放/暂停（仅在文件列表有焦点时生效）

### 无障碍支持
- ✅ 屏幕阅读器完整支持
- ✅ 控件名称和功能朗读
- ✅ 操作状态文字反馈
- ✅ 详细错误信息提示
- ✅ 快捷键语音提示

## 🔧 修复的问题

### v1.0.0 修复内容
- ✅ **版本管理系统**：重构版本管理，采用语义化版本控制
- ✅ **版权信息错误**：修复版权显示中的KeyError错误
- ✅ **API错误处理**：改进HTML响应处理，增强连接稳定性
- ✅ **代码组织**：整理项目结构，提高代码可维护性
- ✅ **文档完善**：更新所有文档，保持版本信息一致性

### v0.4.0 修复内容
- ✅ **文件夹导航功能**：实现双击进入子文件夹，退格键返回上级目录
- ✅ **API接口优化**：修复文件列表获取的API端点和认证问题
- ✅ **界面简化**：删除服务器选择页面多余的确定和取消按钮
- ✅ **切换服务器优化**：去除确认对话框，直接切换服务器
- ✅ **Tab导航修复**：修复服务器选择页面Tab键无法导航到按钮的问题
- ✅ **快捷键修正**：修正文件管理窗口的退格键功能

### v0.3.0 修复内容
- ✅ **添加服务器功能**：修复了添加服务器后不显示在列表中的问题
- ✅ **连接按钮功能**：修复了连接按钮无反应的问题
- ✅ **错误提示优化**：改进了连接失败时的错误提示机制
- ✅ **状态反馈增强**：添加了连接过程的实时状态更新
- ✅ **快捷键格式**：统一使用标准`(&字母)`格式
- ✅ **代码清理**：删除了无用的测试文件和过时代码

## 📖 详细文档

- **[HELP_DOCUMENTATION.md](HELP_DOCUMENTATION.md)** - 完整的用户帮助文档
- **[CLAUDE.md](CLAUDE.md)** - 开发团队配置和指南
- **[VERSION_GUIDE.md](VERSION_GUIDE.md)** - 版本管理指南

## 🛡️ 安全特性

- 密码采用Fernet对称加密存储
- 支持HTTPS连接和SSL证书验证
- 可选的SSL证书忽略（用于自签名证书）
- 配置文件本地存储，数据安全可控

## 🎵 音频播放功能

### 支持的媒体格式
- **音频格式**：MP3, WAV, FLAC, OGG, AAC, M4A等VLC支持的所有音频格式
- **视频格式**：MP4, AVI, MKV, MOV等VLC支持的所有视频格式

### 播放控制
- **菜单控制**：通过"播放(&P)"菜单控制所有播放功能
- **快捷键控制**：使用快捷键快速控制播放
- **空格键控制**：在文件列表中选择音频文件后按空格键播放
- **状态栏显示**：5字段状态栏实时显示播放状态、时间、进度、音量和倍速

### 播放特性
- **智能播放**：音频文件在文件管理器中直接播放，视频文件使用独立播放器窗口
- **播放列表**：自动识别当前目录的音频文件，支持上一个/下一个导航
- **设备选择**：支持选择不同的音频输出设备
- **倍速播放**：支持0.5x到3.0x的倍速播放
- **音量控制**：支持音量调节和静音功能

### 使用方法
1. **播放音频文件**：
   - 在文件列表中选择音频文件
   - 按空格键或使用播放菜单的"播放/暂停"
   - 或双击音频文件直接播放

2. **播放控制**：
   - 使用播放菜单或快捷键控制播放
   - 快进快退、调节音量、切换倍速
   - 上一个/下一个文件导航

3. **查看播放状态**：
   - 状态栏显示当前播放状态
   - 显示播放时间、进度、音量和倍速信息

## 📝 更新历史

### v1.1.0 (2025-10-17) - 音频播放功能版 ✨
- 🎵 **新增音频播放功能**：集成VLC音频播放器，支持音频文件直接播放
- 🎛️ **完整播放控制**：播放菜单、快捷键、状态栏一体化播放控制
- 🎧 **音频设备选择**：支持选择不同的音频输出设备
- ⏯️ **播放列表导航**：自动播放列表，支持上一个/下一个文件导航
- 🔄 **播放功能**：快进快退、音量调节、倍速播放（0.5x-3.0x）
- 📊 **5字段状态栏**：显示播放状态、时间、进度、音量、倍速
- 🎬 **视频播放支持**：视频文件继续使用独立播放器窗口
- ⌨️ **空格键控制**：在文件列表中有焦点时按空格键播放/暂停
- 🎯 **智能播放策略**：音频文件集成播放，视频文件独立窗口播放

### v1.0.0 (2025-10-16) - 稳定版发布
- 重构版本管理系统，采用语义化版本控制
- 修复版权信息显示错误（copyright_end_year问题）
- 改进API客户端错误处理，解决HTML响应问题
- 优化连接测试的容错性
- 完善版本管理工具函数
- 整理项目文档和代码结构

### v0.4.0 (2025-10-16) - 功能完善版
- 实现文件夹导航功能（双击进入，退格键返回）
- 修复文件列表API接口和JWT认证问题
- 简化服务器选择界面，删除多余按钮
- 优化服务器切换流程，去除确认对话框
- 修复Tab导航无法切换到按钮的问题
- 修正退格键返回上级目录功能

### v0.3.0 (2025-10-15) - 问题修复版
- 修复添加服务器功能不保存数据的问题
- 修复连接按钮无反应的问题
- 优化错误提示和状态反馈机制
- 统一快捷键显示格式
- 清理无用的测试文件和代码

### v0.2.0 (2025-10-14) - 界面优化版
- 简化无障碍架构实现
- 修复Tab导航问题
- 优化用户界面设计
- 完善文档系统

### v0.1.0 (2025-10-13) - 初始版
- 初始版本发布
- 基本服务器管理功能
- 完整无障碍支持

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个项目。

---

*专为视障用户设计的OpenList服务器管理工具*