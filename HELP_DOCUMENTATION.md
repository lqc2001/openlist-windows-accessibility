# OpenList Windows管理工具 - 完整帮助文档

## 目录

1. [软件简介](#软件简介)
2. [系统要求](#系统要求)
3. [安装与运行](#安装与运行)
4. [功能特性](#功能特性)
5. [用户界面](#用户界面)
6. [操作指南](#操作指南)
7. [快捷键参考](#快捷键参考)
8. [无障碍功能](#无障碍功能)
9. [技术架构](#技术架构)
10. [开发信息](#开发信息)
11. [故障排除](#故障排除)
12. [更新历史](#更新历史)

---

## 软件简介

OpenList Windows管理工具是一个基于wxPython开发的OpenList服务器管理工具，专为视障用户设计，提供完整无障碍支持。该工具允许用户轻松管理多个OpenList服务器连接，支持添加、编辑、删除服务器配置，并提供安全的密码存储功能。

### 设计原则

- **简单但有效**：遵循简化设计原则，避免过度复杂的实现
- **无障碍优先**：专为视障用户优化，100%键盘可操作
- **稳定可靠**：使用成熟的技术栈，确保程序稳定运行
- **用户友好**：直观的界面设计，清晰的操作反馈

---

## 系统要求

### 基本要求
- **操作系统**：Windows 10/11
- **Python版本**：Python 3.8+
- **屏幕阅读器**：推荐NVDA或其他兼容读屏软件

### 依赖包
```bash
pip install -r requirements.txt
```

主要依赖：
- `wxPython`：图形用户界面框架
- `cryptography`：密码加密存储
- 其他标准库模块

---

## 安装与运行

### 开发环境运行
```bash
# 克隆或下载项目
cd openlist-windows

# 安装依赖
pip install -r requirements.txt

# 运行程序（默认关闭日志，推荐）
python main.py

# 运行程序（开启日志输出，用于调试）
# Windows 命令提示符
set OPENLIST_LOG_LEVEL=ON
python main.py

# Windows PowerShell
$env:OPENLIST_LOG_LEVEL='ON'
python main.py

# 或者直接设置
OPENLIST_LOG_LEVEL=ON python main.py
```

### 测试功能
```bash
# 测试程序启动
python test_startup.py

# 测试Tab导航
python test_tab_navigation.py

# 测试无障碍功能
python test_accessibility.py

# 快速Tab导航测试
python quick_tab_test.py
```

### 打包为可执行文件
```bash
python build.py
```

---

## 功能特性

### 🔗 连接管理
- 支持多个OpenList服务器连接配置
- 安全的服务器密码存储
- 自动连接测试和验证
- 支持自签名HTTPS证书
- 快速服务器切换（Ctrl+Q，无确认对话框）

### 📁 文件管理
- 登录后直接进入文件管理界面
- 实时文件列表显示和刷新
- 完整的文件夹导航功能
- 文件信息查看、复制文件名和路径

### 🎵 音频播放功能
- 集成VLC音频播放器，支持直接播放音频文件
- 完整的播放菜单系统，包含所有播放控制功能
- 智能播放策略：音频文件集成播放，视频文件独立窗口播放
- 5字段状态栏实时显示播放状态、时间、进度、音量和倍速
- 自动播放列表导航，支持上一个/下一个文件切换
- 音频输出设备选择功能
- 倍速播放支持（0.5x到3.0x）
- 完整的快捷键控制系统

### 📂 文件夹导航
- 双击文件夹进入子目录
- 退格键返回上级目录
- 当前路径实时显示
- 支持多级目录浏览

### ♿ 无障碍支持
- 100%键盘可操作界面
- 完整的屏幕阅读器支持
- 清晰的焦点指示和语音反馈
- 符合无障碍标准的控件设计
- 完善的Tab导航系统

### ⌨️ 键盘导航
- 完整的Tab键导航系统
- 智能快捷键支持
- 流畅的控件切换体验
- 无Windows系统蜂鸣声
- 简洁的界面设计，无多余控件

### 🔒 安全特性
- 密码采用Fernet加密存储
- 配置文件安全保护
- 支持SSL/TLS连接
- 可选SSL证书验证绕过

---

## 用户界面

### 主界面布局

```
OpenList管理器
┌─────────────────────────────────────────────────────────────┐
│ 文件(F)  帮助(H)                                           │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ 服务器选择: [下拉菜单                    ▼]                   │
│                                                             │
│           连接(&L)  添加(&A)  编辑(&E)  删除(&D)            │
│                                                             │
│ ─────────────────────────────────────────────────────────── │
│                                                             │
│                                                             │
│            (为将来的功能预留区域)                           │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 菜单栏

- **文件(F)**：切换服务器、退出程序
- **帮助(H)**：关于信息

### 主要控件

1. **服务器选择下拉框**：选择要连接的服务器
2. **连接(&L) 按钮**：连接到选中的服务器
3. **添加(&A) 按钮**：添加新的服务器配置
4. **编辑(&E) 按钮**：编辑选中的服务器配置
5. **删除(&D) 按钮**：删除选中的服务器配置

---

## 操作指南

### 基本操作流程

1. **启动程序**
   - 运行 `python main.py`
   - 焦点自动位于"服务器选择"下拉框

2. **添加服务器**
   - 按 `Alt+A` 或Tab导航到"添加"按钮
   - 填写服务器信息：名称、地址、用户名、密码
   - 点击确定保存配置

3. **连接服务器**
   - 在下拉框中选择服务器
   - 按 `Alt+L` 或点击"连接"按钮
   - 等待连接完成，自动进入文件管理界面

4. **文件管理**
   - 双击文件夹进入子目录
   - 按退格键返回上级目录
   - 查看文件列表和详细信息

5. **切换服务器**
   - 按 `Ctrl+Q` 直接切换到其他服务器（无确认对话框）
   - 选择新服务器并连接

6. **管理服务器配置**
   - 使用方向键选择不同服务器
   - 使用编辑/删除按钮管理现有配置

### 详细操作步骤

#### 添加新服务器

1. 按 `Alt+A` 打开添加服务器对话框
2. 填写必填信息：
   - **服务器名称**：显示在列表中的名称
   - **服务器地址**：如 `example.com` 或 `https://example.com`
   - **用户名**：登录用户名
   - **密码**：登录密码
3. 可选信息：
   - **端口**：留空使用默认端口
   - **忽略SSL证书错误**：用于自签名证书
4. 按回车或点击确定保存

#### 连接到服务器

1. 在服务器选择框中选择目标服务器
2. 按 `Alt+L` 或点击连接按钮
3. 等待连接过程完成
4. 连接成功后状态会更新

#### 编辑服务器配置

1. 选择要编辑的服务器
2. 按 `Alt+E` 或点击编辑按钮
3. 修改需要更改的信息
4. 密码字段可以留空以保持原密码
5. 保存更改

#### 删除服务器

1. 选择要删除的服务器
2. 按 `Alt+D` 或点击删除按钮
3. 确认删除操作
4. 服务器配置将被永久删除

---

## 快捷键参考

#### 服务器选择界面快捷键

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `Alt+L` | 连接服务器 | 连接到当前选中的服务器 |
| `Alt+A` | 添加服务器 | 打开添加服务器对话框 |
| `Alt+E` | 编辑服务器 | 编辑选中的服务器配置 |
| `Alt+D` | 删除服务器 | 删除选中的服务器配置 |
| `F1` | 关于 | 显示程序关于信息 |
| `Alt+F4` | 退出 | 退出程序 |

#### 文件管理界面快捷键

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `Ctrl+Q` | 切换服务器 | 快速切换到其他服务器（无确认对话框） |
| `F5` | 刷新文件列表 | 重新加载当前目录的文件列表 |
| `Ctrl+A` | 全选文件 | 选择当前目录中的所有文件 |
| `Ctrl+I` | 反选文件 | 反向选择文件 |
| `Ctrl+C` | 复制文件名 | 复制选中文件的名称到剪贴板 |
| `Ctrl+Shift+C` | 复制文件路径 | 复制选中文件的完整路径到剪贴板 |
| `Enter` | 打开文件/文件夹 | 双击或回车打开文件或进入文件夹 |
| `Backspace` | 返回上级目录 | 从当前目录返回上一级目录 |
| `Alt+F4` | 退出程序 | 退出程序 |

### 导航快捷键

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `Tab` | 正向导航 | 在控件间正向切换焦点 |
| `Shift+Tab` | 反向导航 | 在控件间反向切换焦点 |
| `方向键` | 选择项目 | 在下拉框中选择服务器 |
| `回车键` | 确认操作 | 确认选择或连接服务器 |
| `空格键` | 激活按钮 | 激活当前焦点的按钮 |

### 菜单快捷键

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `Ctrl+Tab` | 切换服务器 | 从菜单切换到服务器选择 |
| `Alt` | 激活菜单 | 激活菜单栏 |
| `Esc` | 关闭对话框 | 关闭当前对话框 |

---

## 🎵 音频播放功能详解

### 播放菜单系统

程序在文件管理界面提供了完整的"播放(&P)"菜单，包含以下功能：

#### 音频设备选择
- **默认设备**：使用系统默认音频输出设备
- **扬声器**：强制使用扬声器输出
- **耳机**：强制使用耳机输出

#### 播放控制
- **播放/暂停 (Ctrl+Home)**：开始或暂停播放
- **停止 (Ctrl+End)**：停止当前播放

#### 播放列表控制
- **上一个 (Ctrl+PageUp)**：播放当前目录中的上一个音频文件
- **下一个 (Ctrl+PageDown)**：播放当前目录中的下一个音频文件

#### 播放进度控制
- **快退5秒 (Ctrl+Left)**：向后快退5秒
- **快进5秒 (Ctrl+Right)**：向前快进5秒

#### 音量控制
- **音量增加 (Ctrl+Up)**：增加音量
- **音量减少 (Ctrl+Down)**：减少音量

#### 播放倍速选择
- **0.5倍速**：慢速播放
- **1.0倍速**：正常速度（默认）
- **1.5倍速**：1.5倍速度播放
- **2.0倍速**：2倍速度播放
- **2.5倍速**：2.5倍速度播放
- **3.0倍速**：3倍速度播放

### 状态栏显示

程序底部提供5字段状态栏，实时显示播放信息：

1. **字段1 - 播放状态**：显示当前播放状态和曲目名称
   - 播放中：`播放: 文件名.mp3`
   - 暂停：`暂停: 文件名.mp3`
   - 停止：`停止`

2. **字段2 - 播放时间**：显示当前时间/总时间
   - 格式：`01:23/03:45`

3. **字段3 - 播放进度**：显示播放进度百分比
   - 格式：`37.5%`

4. **字段4 - 音量**：显示当前音量
   - 格式：`音量:75%`

5. **字段5 - 播放倍速**：显示当前播放倍速
   - 格式：`1.0x`

### 智能播放策略

程序采用智能播放策略：

#### 音频文件
- **集成播放**：在文件管理器中直接播放，不打开新窗口
- **空格键控制**：选择音频文件后按空格键播放/暂停
- **后台播放**：播放时可以继续浏览文件

#### 视频文件
- **独立播放器**：打开专门的播放器窗口
- **完整控制**：提供完整的视频播放控制界面

### 播放操作方法

#### 方法1：通过文件列表播放
1. 在文件列表中选择音频文件
2. 按空格键播放/暂停
3. 或双击音频文件直接播放

#### 方法2：通过菜单播放
1. 选择音频文件
2. 按`Alt+P`打开播放菜单
3. 选择"播放/暂停"

#### 方法3：通过快捷键播放
1. 选择音频文件
2. 按`Ctrl+Home`播放/暂停

### 播放列表导航

程序自动识别当前目录中的所有音频文件：

#### 自动播放列表
- 自动扫描当前目录的音频文件
- 按文件名排序创建播放列表
- 支持循环播放

#### 上一个/下一个导航
- `Ctrl+PageUp`：播放上一个音频文件
- `Ctrl+PageDown`：播放下一个音频文件
- 到达列表开头时，上一个会跳到最后一个
- 到达列表末尾时，下一个会跳到第一个

### 支持的媒体格式

#### 音频格式
- MP3 (.mp3)
- WAV (.wav)
- FLAC (.flac)
- OGG (.ogg)
- AAC (.aac, .m4a)
- WMA (.wma)
- 其他VLC支持的所有音频格式

#### 视频格式
- MP4 (.mp4)
- AVI (.avi)
- MKV (.mkv)
- MOV (.mov)
- WMV (.wmv)
- 其他VLC支持的所有视频格式

### 播放控制技巧

#### 快速控制
- 使用`Ctrl+Up/Down`快速调节音量
- 使用`Ctrl+Left/Right`快速快进快退
- 使用播放菜单精确控制倍速

#### 播放状态查看
- 状态栏实时显示播放信息
- 屏幕阅读器会朗读播放状态变化
- 操作后状态栏会显示操作结果

#### 多文件播放
- 选择一个音频文件播放后，可以使用上一个/下一个功能
- 不需要手动选择文件即可连续播放
- 支持在播放过程中浏览文件

---

## 无障碍功能

### 屏幕阅读器支持

本软件完全支持屏幕阅读器，包括：

- **控件识别**：所有控件都有正确的名称和描述
- **焦点朗读**：焦点变化时自动朗读控件信息
- **状态通知**：操作完成后朗读结果状态
- **错误提示**：错误时朗读详细错误信息

### Tab导航系统

#### 导航顺序
1. 服务器选择框
2. 连接(&L) 按钮
3. 添加(&A) 按钮
4. 编辑(&E) 按钮
5. 删除(&D) 按钮

#### 技术实现
- 使用Panel作为控件容器确保稳定的Tab导航
- 保持所有按钮启用状态支持完整导航
- 避免Tab快捷键冲突
- 使用wxPython原生焦点管理

### 语音反馈

虽然简化了复杂的语音反馈系统，但保留了：

- **控件名称朗读**：通过SetName()设置
- **控件描述朗读**：通过SetHelpText()设置
- **状态变化通知**：操作结果的文字反馈
- **系统提示音**：使用标准Windows提示音

### 无障碍设计原则

1. **简单有效**：避免过度复杂的自定义实现
2. **原生支持**：依赖wxPython内置无障碍功能
3. **一致性**：所有控件使用统一的命名规范
4. **可测试性**：定期使用屏幕阅读器验证功能

---

## 技术架构

### 项目结构

```
openlist-windows/
├── main.py                      # 主程序入口
├── requirements.txt             # 依赖包列表
├── build.py                     # 打包脚本
├── README.md                    # 项目说明
├── HELP_DOCUMENTATION.md        # 完整帮助文档
├── config/                      # 配置文件目录
├── logs/                        # 日志文件目录
├── cache/                       # 缓存文件目录
├── tmp/                         # 临时文件目录
├── src/                         # 源代码目录
│   ├── ui/                      # 用户界面模块
│   │   ├── main_frame.py        # 主窗口界面
│   │   └── server_dialog.py     # 服务器配置对话框
│   ├── core/                    # 核心功能模块
│   │   ├── config_manager.py    # 配置管理器
│   │   └── logger.py            # 日志系统
│   ├── api/                     # API客户端模块
│   │   └── openlist_client.py   # OpenList客户端
│   └── accessibility/           # 无障碍功能模块(已简化)
└── resources/                   # 资源文件目录
```

### 核心组件

#### MainFrame（主窗口）
- 简化的用户界面设计
- 完整的Tab导航支持
- 原生无障碍功能集成
- 响应式布局管理

#### ConfigManager（配置管理）
- 安全的密码加密存储
- JSON格式配置文件
- 自动配置目录创建
- 错误处理和恢复

#### OpenListClient（API客户端）
- HTTP/HTTPS通信支持
- 自签名证书处理
- 连接状态管理
- 错误重试机制

### 设计模式

- **MVC模式**：分离界面、数据和逻辑
- **工厂模式**：统一的配置管理
- **观察者模式**：事件驱动的界面更新
- **策略模式**：灵活的错误处理策略

---

## 开发信息

### 开发环境设置

1. **安装Python**：确保Python 3.8+
2. **安装依赖**：`pip install -r requirements.txt`
3. **配置IDE**：推荐使用支持Python的IDE
4. **运行测试**：执行测试脚本验证功能

### 代码规范

- **PEP 8**：遵循Python代码风格指南
- **类型提示**：使用类型注解提高代码可读性
- **文档字符串**：为所有函数和类添加文档
- **错误处理**：完善的异常处理机制

### 测试策略

- **单元测试**：核心功能的单元测试
- **集成测试**：完整流程的集成测试
- **无障碍测试**：屏幕阅读器兼容性测试
- **用户测试**：真实用户场景测试

### 构建和部署

```bash
# 开发模式运行
python main.py

# 构建可执行文件
python build.py

# 运行测试
python test_startup.py
```

---

## 故障排除

### 常见问题

#### 1. 程序无法启动
**可能原因**：
- 缺少依赖包
- Python版本不兼容
- 配置文件损坏

**解决方法**：
```bash
# 重新安装依赖
pip install -r requirements.txt

# 删除配置目录重试
rmdir /s config
```

#### 2. 需要调试信息
**问题描述**：程序运行时没有输出调试信息，需要查看详细日志进行问题排查

**解决方法**：
```bash
# 开启日志输出
# Windows 命令提示符
set OPENLIST_LOG_LEVEL=ON
python main.py

# Windows PowerShell
$env:OPENLIST_LOG_LEVEL='ON'
python main.py
```

**说明**：
- 默认情况下程序不会输出任何调试信息，提供清爽的使用体验
- 设置环境变量 `OPENLIST_LOG_LEVEL=ON` 可以开启详细日志输出
- 开启日志后会显示详细的API请求和响应信息，便于调试和开发

#### 3. Tab导航不工作
**可能原因**：
- 系统快捷键冲突
- 屏幕阅读器干扰
- 窗口焦点问题

**解决方法**：
- 重启程序重新设置焦点
- 检查系统快捷键设置
- 尝试不同的屏幕阅读器设置

#### 5. 连接服务器失败
**可能原因**：
- 服务器地址错误
- 网络连接问题
- SSL证书问题

**解决方法**：
- 验证服务器地址和端口
- 检查网络连接
- 尝试忽略SSL证书错误

#### 6. 密码保存失败
**可能原因**：
- 配置目录权限问题
- 磁盘空间不足
- 加密模块错误

**解决方法**：
- 检查配置目录权限
- 清理磁盘空间
- 重新安装cryptography模块

### 日志分析

程序运行日志位于 `logs/` 目录：
- `debug_YYYYMMDD.log`：详细的调试日志
- 包含错误信息、操作记录、状态变化

### 获取帮助

如遇到问题，请：
1. 查看本文档的相关章节
2. 检查程序日志文件
3. 尝试重新启动程序
4. 联系技术支持

---

## 更新历史

### v1.1.0 (当前版本) - 音频播放功能版 (2025-10-17)
- 🎵 **新增音频播放功能**：集成VLC音频播放器，支持音频文件直接播放
- 🎛️ **完整播放菜单系统**：添加"播放(&P)"菜单，包含所有播放控制功能
- 🎧 **音频设备选择**：支持选择不同的音频输出设备
- ⏯️ **播放列表导航**：自动识别当前目录音频文件，支持上一个/下一个切换
- 🔄 **播放控制功能**：快进快退、音量调节、倍速播放（0.5x-3.0x）
- 📊 **5字段状态栏**：实时显示播放状态、时间、进度、音量和倍速
- 🎬 **智能播放策略**：音频文件集成播放，视频文件独立窗口播放
- ⌨️ **空格键控制**：在文件列表中有焦点时按空格键播放/暂停
- 🎯 **完整快捷键系统**：8个播放控制快捷键，支持完整的键盘操作
- 🖥️ **VLC集成**：基于VLC 3.0+的稳定媒体播放核心

### v1.0.0 - 稳定版发布 (2025-10-16)
- ✅ **版本管理系统重构**：采用语义化版本控制 (主版本.次版本.修订版本)
- ✅ **修复版权信息错误**：解决版权显示中的KeyError问题
- ✅ **改进API错误处理**：优化HTML响应处理，增强连接稳定性
- ✅ **代码组织优化**：整理项目结构，提高代码可维护性
- ✅ **文档版本同步**：更新所有文档，确保版本信息一致性
- ✅ **版本管理工具**：新增版本号计算和管理工具函数

### v0.4.0 - 功能完善版 (2025-10-16)
- ✅ **新增文件夹导航功能**：双击进入子文件夹，退格键返回上级目录
- ✅ **修复API接口问题**：解决文件列表获取的API端点和JWT认证问题
- ✅ **界面优化**：删除服务器选择页面多余的确定和取消按钮
- ✅ **切换服务器优化**：去除确认对话框，直接切换服务器
- ✅ **修复Tab导航**：解决服务器选择页面Tab键无法导航到按钮的问题
- ✅ **快捷键修正**：修正文件管理窗口的退格键功能

### v0.3.0 - 问题修复版 (2025-10-15)
- ✅ 修复添加服务器功能不保存数据的问题
- ✅ 修复连接按钮无反应的问题
- ✅ 优化错误提示和状态反馈机制
- ✅ 统一快捷键显示格式为标准(&字母)格式
- ✅ 清理无用的测试文件和过时代码
- ✅ 增强连接过程中的状态反馈
- ✅ 完善的错误处理和用户提示

### v0.2.0 - 界面优化版 (2025-10-14)
- ✅ 简化的无障碍架构实现
- ✅ 修复Tab导航问题，支持流畅切换
- ✅ 按钮快捷键提示优化
- ✅ 简化菜单栏结构，删除冗余菜单
- ✅ 完整的帮助文档系统

### v0.1.0 - 初始版 (2025-10-13)
- ✅ 基本服务器管理功能
- ✅ 完整无障碍支持
- ✅ 简化的用户界面
- ✅ 安全的密码存储

#### 功能修复和优化
- 修复添加服务器功能不保存数据的关键问题
- 修复连接按钮无反应的用户体验问题
- 优化错误提示机制，提供详细的错误信息
- 增强连接过程中的实时状态反馈
- 统一快捷键显示格式为标准(&字母)格式

#### 代码清理和重构
- 删除无用的测试文件和调试代码
- 移除过时的accessibility模块
- 清理Python缓存文件和临时文件
- 简化项目结构，保留核心功能

#### 用户体验改进
- 完善错误处理流程，确保用户得到明确反馈
- 优化连接状态的显示和更新机制
- 改进无障碍支持，确保屏幕阅读器兼容性
- 增强操作提示和帮助信息

---

## 许可证

本项目采用 MIT License 开源许可证。

## 贡献指南

欢迎贡献代码和改进建议：
1. Fork 本项目
2. 创建功能分支
3. 提交更改
4. 发起Pull Request

## 联系信息

如有问题或建议，请通过以下方式联系：
- 提交Issue到项目仓库
- 发送邮件到开发团队

---

*本文档最后更新时间：2025年10月17日*