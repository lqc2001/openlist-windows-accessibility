# OpenList Windows管理工具 - Claude Code 配置

## 项目概述

这是一个基于wxPython开发的OpenList服务器Windows管理工具，专为视障用户设计，提供完整无障碍支持。

## 开发指导原则

### 无障碍设计原则
- **简单但有效**：避免过度复杂的自定义无障碍实现
- **原生支持优先**：使用wxPython内置的无障碍功能
- **键盘导航完整性**：确保所有功能都可以通过键盘操作
- **屏幕阅读器兼容**：与NVDA等主流屏幕阅读器兼容

### Tab导航最佳实践
1. **使用Panel作为控件容器**：确保Tab导航稳定
2. **保持控件启用状态**：即使功能受限也要保持Tab可访问
3. **避免Tab快捷键冲突**：不在菜单中使用Tab快捷键
4. **简单的线性布局**：按Tab顺序添加控件

## 代码规范

### 文件结构规范
```
src/
├── ui/           # 用户界面模块
├── core/         # 核心功能模块
├── api/          # API客户端模块
├── media/        # 媒体播放模块
└── accessibility/ # 无障碍功能模块（简化版）
```

### 命名规范
- **类名**：PascalCase（如 `MainFrame`）
- **函数名**：snake_case（如 `create_ui`）
- **变量名**：snake_case（如 `server_combo`）
- **常量名**：UPPER_SNAKE_CASE

### 无障碍属性设置
```python
# 控件名称设置
control.SetName("简洁明确的名称")

# 帮助文本设置
control.SetHelpText("详细的功能描述，包含快捷键信息")

# 示例
self.connect_btn = wx.Button(panel, label="连接(&L)")
self.connect_btn.SetName("连接按钮")
self.connect_btn.SetHelpText("连接到选中的OpenList服务器 (Alt+L)")
```

## 常见任务模式

### 添加新功能
1. 首先考虑无障碍影响
2. 确保支持键盘导航
3. 添加适当的SetName和SetHelpText
4. 测试屏幕阅读器兼容性

### 修复Bug
1. 优先检查无障碍相关代码
2. 测试Tab导航是否正常
3. 验证快捷键功能
4. 确保错误信息对屏幕阅读器友好

### 优化性能
1. 避免阻塞主线程
2. 合理使用异步操作
3. 注意内存泄漏
4. 保持界面响应性

### 音频播放功能开发
1. **媒体检测**：使用MediaFileDetector检测文件类型
2. **播放器集成**：优先使用AudioPlayerController进行集成播放
3. **状态管理**：确保播放状态与UI实时同步
4. **资源管理**：正确初始化和清理VLC资源
5. **错误处理**：完善VLC库加载和播放错误处理
6. **无障碍支持**：确保所有播放功能都有键盘访问支持

## 禁止的操作

### ❌ 不要做的事情
- 不要实现复杂的自定义无障碍类
- 不要手动控制Tab顺序
- 不要拦截Tab键事件
- 不要创建复杂的语音反馈系统
- 不要在菜单中使用Tab快捷键

### ✅ 推荐的做法
- 使用wxPython原生无障碍支持
- 保持控件启用状态支持Tab导航
- 简洁的控件命名和描述
- 标准的键盘快捷键实现

## 测试要求

### 必须测试的功能
- [ ] 程序正常启动
- [ ] Tab导航在所有控件间正常工作
- [ ] 所有快捷键正常响应
- [ ] 按钮文本包含快捷键提示
- [ ] 屏幕阅读器能正确朗读控件信息

### 音频播放功能测试
- [ ] 音频播放控制器初始化成功
- [ ] 播放菜单系统正常工作
- [ ] 播放快捷键响应正确
- [ ] 状态栏显示播放信息准确
- [ ] 空格键播放/暂停功能正常
- [ ] 音频设备切换功能正常
- [ ] 倍速播放功能正常
- [ ] 播放列表导航正常
- [ ] VLC库加载和错误处理正常

### 测试工具
```bash
# 启动测试
python test_startup.py

# Tab导航测试
python test_tab_navigation.py

# 无障碍功能测试
python test_accessibility.py

# 音频播放功能测试
python test_audio_player_integration.py
```

## 文档维护

### 更新文档时
1. 重大功能更新：更新README.md
2. 详细功能说明：更新HELP_DOCUMENTATION.md
3. 开发指南更新：更新CLAUDE.md
4. 删除过时的单独报告文档

### 文档结构
- `README.md` - 用户快速开始指南
- `HELP_DOCUMENTATION.md` - 完整用户帮助文档
- `CLAUDE.md` - 开发团队配置和指南
- `AUDIO_PLAYER_UPDATE_SUMMARY.md` - 音频播放功能更新总结
- `VERSION_UPDATE_v1.1.0.md` - v1.1.0版本更新记录
- `DOCUMENTATION_INDEX.md` - 文档索引

## 项目特定配置

### 快捷键约定
- `Alt+字母`：主要功能快捷键
- `F1`：帮助信息
- `Ctrl+Tab`：切换功能
- `Alt+F4`：退出程序

### 音频播放快捷键约定
- `Ctrl+Home`：播放/暂停音频
- `Ctrl+End`：停止播放
- `Ctrl+PageUp/PageDown`：上一个/下一个曲目
- `Ctrl+Left/Right`：快退/快进
- `Ctrl+Up/Down`：音量控制
- `空格键`：播放/暂停（文件列表焦点时）

### 界面布局约定
- 使用Panel作为主要容器
- 简洁的线性布局
- 一致的间距和对齐
- 清晰的视觉层次

### 错误处理约定
- 使用标准的wx.MessageBox
- 提供清晰的错误信息
- 包含解决建议
- 不使用复杂的错误对话框

## 联系和协作

### 代码审查要点
1. 无障碍功能是否完整
2. Tab导航是否正常
3. 快捷键是否冲突
4. 代码是否符合项目规范

### 问题报告模板
- 问题描述
- 重现步骤
- 期望行为
- 实际行为
- 环境信息（操作系统、屏幕阅读器等）

---

## 版本信息

**当前版本**：v1.1.0 (音频播放功能版)
**最后更新**：2025年10月17日
**主要更新**：新增音频播放功能、媒体播放模块、播放控制快捷键等

---

*此文档由开发团队维护，记录项目特定的开发规范和约定。*